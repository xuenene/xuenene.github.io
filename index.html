<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="路 | Journey">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="路 | Journey">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="路 | Journey">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>路 | Journey</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">路 | Journey</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/30/自动扫雷/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuenene">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xuenene.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路 | Journey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/30/自动扫雷/" itemprop="url">自动扫雷</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-30T02:06:55+08:00">
                2017-05-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default">
</script>

<p>突然有种把小时候玩过的游戏们写成代码的冲动，但是实现个单纯的游戏实在无趣，大部分都是画界面的活，对基本的算法能力考察接近于零。于是决定实现游戏的AI，在代码中注入我曾经玩游戏时的逻辑。</p>
<p>某一时刻，突然想起了“扫雷”，一直被称作是经典益智游戏，时不时看到几个无聊的同学会在实验室没法联网的xp古董机上面兴趣盎然地扫雷。打开电脑，惊奇地发现win10居然不带扫雷，无奈之下只能另觅他处。于是惊喜地发现之前只是装着玩玩的xp虚拟机终于派上用场了，不光能玩扫雷，直接把虚拟机里的exe拖到win10下面居然也能跑起来。想想也对，向后兼容嘛。</p>
<h3 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h3><h4 id="高级模式"><a href="#高级模式" class="headerlink" title="高级模式"></a>高级模式</h4>
<div align="center">
<video src="/video/1/1.mp4" controls="controls"></video>
</div>

<h4 id="英雄榜"><a href="#英雄榜" class="headerlink" title="英雄榜"></a>英雄榜</h4>
<div align="center">

<p><img src="/img/2/1.png" alt="image"><br>
</p></div>
<p></p>
<h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p><a href="https://zh.wikipedia.org/wiki/%E8%B8%A9%E5%9C%B0%E9%9B%B7" target="_blank" rel="external">扫雷</a>是Windows平台下的经典益智游戏。要顺利完成游戏，必须要有缜密的逻辑能力，很多时候还需要一点运气。</p>
<h4 id="内存读雷法"><a href="#内存读雷法" class="headerlink" title="内存读雷法"></a>内存读雷法</h4><p>通俗地讲就是“作弊”，顺着进程去读取游戏中雷的分布数据。</p>
<p>这种方法效率最高，且成功率100%，再难的局也能从容应对。不过这么做显然失去了游戏的乐趣，等于变魔术的人找了个托，骗骗外行够用，自己本身并没有太大的成就感。</p>
<h4 id="逻辑扫雷法"><a href="#逻辑扫雷法" class="headerlink" title="逻辑扫雷法"></a>逻辑扫雷法</h4><p>模拟人的逻辑推理，找出未知块中一定是雷和一定非雷的块，将非雷的块都翻开，再重新分析新局面，直到找出所有的雷。</p>
<p>缺点是总会产生无确定安全块的局面，即剩下的所有块都有是雷的可能。这种情况下可以参考“人品避雷法”和“概率蒙雷法”。</p>
<h4 id="人品避雷法"><a href="#人品避雷法" class="headerlink" title="人品避雷法"></a>人品避雷法</h4><p>随机点击未知块，凭借强大的人品完美的避开所有雷块获得游戏胜利。</p>
<p>这种方法获胜概率不高，但玩游戏的代价也极低，完全不用动脑，且理论上确实存在获胜的可能性。</p>
<h4 id="概率猜雷法"><a href="#概率猜雷法" class="headerlink" title="概率猜雷法"></a>概率猜雷法</h4><p>适合与逻辑判断法混合使用以达到最佳效果。很多局面下无法明确雷的具体分布，但是各个位置上有雷的概率（以下简称“雷率”）往往是不同的。考虑以下简单局面：数字“1”周围8个未知块，数字“7”周围也是8个未知块，两部分未知块间并无交集且暂无其他有效信息——虽然这16个块都有雷的可能，但是显然点击“1”的邻块较为安全。每次选取未知块中雷率最小的并点击。</p>
<p>需要说明的是此法无法保证100%，只能通过概率的推算提高大样本数据下的胜率，单独一盘游戏的某个局面完全可能存在“雷率最小的块是雷”这一事件，所以还是只能叫“猜”雷，而不是“扫”雷。</p>
<p>此法需要强大的排列组合推算能力，技术含量极高，据说是微软的面试题。我勉强可以推算出一些简单情况的雷率，对于复杂情况无法估计，也很难编程实现。当然也有“所有未知块是雷的概率完全相等”的情况，例如开局或者盘末的“生死雷”（如图），这时请继续参考“人品避雷法”。<br><div align="center"><br><img src="/img/2/2.png" alt="image"><br>
</div>
</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>谈回“扫雷”本身，既然是个游戏，则必然有其内在的逻辑，把逻辑转换成代码就能完成自动扫雷，当然逻辑的转换完成度决定了算法的优劣以及游戏的胜率。其次，图像识别也是其中的关键，既然咱不屑去读内存，必然只能通过GUI，即扫雷的窗口获取当前局面信息。</p>
<p>考虑采用“逻辑扫雷法”和“人品避雷法”，整个流程大致思路如下：</p>
<ol>
<li>获取当前局面；</li>
<li>建模后在未知块中选择所有必非雷的块，若无此类块，则在未知块中选择一块除必雷块外的随机块；</li>
<li>点击所有选中的块；</li>
<li>判断当前局面是否结束（胜利或失败），若未结束则返回步骤1。</li>
</ol>
<h4 id="局面分析"><a href="#局面分析" class="headerlink" title="局面分析"></a>局面分析</h4><p>其中2是整个AI中的关键一步，若能在算法中注入所有人类能做出的推断，则称得上是个完美算法。接口的输入为局面信息，输出为三个集合：未知块必雷集合，未知块必非雷集合以及余下未知块集合。</p>
<h5 id="线性方程组"><a href="#线性方程组" class="headerlink" title="线性方程组"></a>线性方程组</h5><p>考虑其细节实现，已知信息为已知块中的数字，其意义为已知为中心的九宫格（边角超出部分不计）中的块中雷的个数。这显然是个数学问题，如果把位于第\(i\)行第\(j\)列的块作为一个未知量\(x_{ij}\)，很容易想到根据每个已知数字都可以列出一个不定方程。</p>

<div align="center">

<p><img src="/img/2/2.png" alt="image"><br>\(x_{01} + x_{02} + x_{10} + x_{12} + x_{22} = 4\)<br>\(x_{10} + x_{12} + x_{22} + x_{31} + x_{32} = 4\)<br>
</p></div>
<p></p>
<p>这样列出的若干个方程似乎已经包含了局面已知的所有信息。一开始觉得这不就是解个线性方程组么，<a href="https://zh.wikipedia.org/wiki/%E9%AB%98%E6%96%AF%E6%B6%88%E5%8E%BB%E6%B3%95" target="_blank" rel="external">高斯消元法</a>一下就搞定了。试着解一解才发现事情并没有想象中那么简单，因为还有一个隐藏的条件并没有用上——每个\(x\)的取值只能是\(0\)或者\(1\)。我们在构造线性方程组的时候并没有限定未知数的取值，所以要加入这个约束。是否可以构造一些新的线性方程组来间接约束\(x\)只能等于\(0\)或者\(1\)？考虑后得知这并不容易，因为我们都知道，线性方程组的解的情况只有三种——无解、有唯一解或者有无穷多解，并不可能构造一组n元的线性方程组有\(2^n\)个解。于是因为少了一个约束条件导致解线性方程组方法失效，其只有在唯一解的情况下可以求出这个解，即只要有一个未知块不确定，该法就不适用，而基本上每个局面都会有无法判断的未知块。</p>
<h5 id="SAT"><a href="#SAT" class="headerlink" title="SAT"></a>SAT</h5><p>需要解决的问题是给出一些未知bool变量和若干个与这些变量有关的等式，需要给这些变量一一赋值，以满足所有等式，有一定算法基础的人不难联想到这是个<a href="https://zh.wikipedia.org/wiki/%E5%B8%83%E5%B0%94%E5%8F%AF%E6%BB%A1%E8%B6%B3%E6%80%A7%E9%97%AE%E9%A2%98" target="_blank" rel="external">SAT问题</a>。SAT问题是个经典<a href="https://zh.wikipedia.org/wiki/NP%E5%AE%8C%E5%85%A8" target="_blank" rel="external">NP完全问题</a>，这似乎意味着高成功率的自动扫雷无法实现？但是扫雷的逻辑看起来很简单，且数据量很小，通过搜索+剪枝应该也能完成这个工作。通过查找相关资料并自己分析，发现可以尝试着解决SAT的子问题2-SAT。</p>
<p>2-SAT问题在参加ACM竞赛时有过了解，也做过几道模板题。与它的父问题SAT的区别是他的判定式通常最多只含有两个未知变量，且常以bool运算的形式存在，常见的有 \(x\land y = true\)、\(x\lor y = false\)、\(x\oplus y = true\)，\(\lnot x = false\)等。通过式子可以在两个元素间建立一定联系，如当\(x\oplus y = true\)时可推出两个逻辑命题：</p>
<ol>
<li>\(x\to\lnot y\)</li>
<li>\(\lnot x\to y\)</li>
</ol>
<p>在扫雷问题中，我们也可以从已知信息中推出一些逻辑命题，将SAT“转化”为2-SAT问题，使之存在多项式时间复杂度的解决方法，主要是以下8类：</p>
<ol>
<li>\(数字-周围已知雷数=周围未知块数\Longleftrightarrow周围未知块均为雷\)</li>
<li>\(数字-周围已知雷数=0\Longleftrightarrow周围未知块均非雷\)</li>
<li>\(数字-周围已知雷数=周围未知块数-1\Longleftrightarrow当周围未知块中某一块非雷时，则剩余块均为雷\)</li>
<li>\(数字-周围已知雷数=1\Longleftrightarrow当周围未知块中某一块为雷时，则剩余块均非雷\)</li>
<li>\(雷总数-已知雷数=未知块数\Longleftrightarrow未知块均为雷\)</li>
<li>\(雷总数-已知雷数=0\Longleftrightarrow未知块均非雷\)</li>
<li>\(雷总数-已知雷数=未知块数-1\Longleftrightarrow当未知块中某一块非雷时，则剩余块均为雷\)</li>
<li>\(数字-周围已知雷数=1\Longleftrightarrow当未知块中某一块为雷时，则剩余块均非雷\)</li>
</ol>
<p>看起来似乎把这个SAT问题转化成了P问题，难道网上那些“扫雷是NP完全问题”的证明是错的？其实不然，这8个逻辑命题并没有涵盖所有的信息，即存在某种情况理论上可以推断出的雷我们却没有将它注入算法中。举个简单的例子：<br>
<div align="center">
<br>\(x_1+x_2+x_3+x_4=2\)<br>\(x_1+x_2+x_3+x_5=3\)<br>
</div>
<br>逻辑正常的人类不难作出\(x_4=0\)和\(x_5=1\)的推断，但是参照之前的转化方案，我们无法将第一个式子转化为有效且简单的逻辑命题，因缺少了部分信息而 而导致无法作出正确推断。或许可以说“当其中任意两个为雷时则剩余两个均非雷”，这是个正确的推断，但这只是考虑等式右边为2的情况，还需考虑3，4，5等更大数字，无疑会大大增加算法时空复杂度和编码复杂度。</p>
<p>实践证明以上8条逻辑推断对于一个并不追求完美的算法已然够用。</p>
<h5 id="随机扫雷"><a href="#随机扫雷" class="headerlink" title="随机扫雷"></a>随机扫雷</h5><p>当局面焦灼时，即无非雷块可选择时，则不得不采用随机数大法，从未知块中随机挑选一个，把命运交给老天爷。</p>
<p>实践证明这个方法在初级和中级的扫雷中屡试不爽，完全够用，但是到了高级就没那么幸运了。</p>
<h4 id="图像识别"><a href="#图像识别" class="headerlink" title="图像识别"></a>图像识别</h4><p>这看起来似乎是个麻烦的模块。我需要程序知道每个数字长啥样，然后告诉分析模块当前局面是什么以便他作出推断。截屏再做数字识别？好像工程量略大，我并不需要通用的AI，只要能在我的电脑上跑起来就行，直觉告诉我应该可以偷偷懒。</p>
<p>Win32的API给我们提供了很多接口，可以获取某个窗口的句柄，也可以获取屏幕上某点的RGB值。不难想到可以先通过像素点获取局面每一格的信息，再抓住各格的不同特征来获取当前格内的信息。不难发现，每个数字颜色不同，在某个相对位置，我们可以在几个拥有特殊RGB值的像素点上作文章。</p>
<h4 id="执行动作"><a href="#执行动作" class="headerlink" title="执行动作"></a>执行动作</h4><p>这其实相当于UI，是向外界展示我的算法成果，即可以实现鼠标自动点击。这看起来最厉害，意料之中的是，这是最简单的，同样是直接调用Win32的API对某个像素点实现自动点击功能。</p>
<p>需要说明的是，完整的扫雷动作库其实应有左键单击，右键单击，左右键一起单击等，而我们的目的是获得游戏胜利，右键标雷等功能对人可能有用，但对程序来讲无任何帮助，故程序只实现了左键单击功能。</p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><p>对局面的存储，主要用两个值来表示每个单元格，一个bool值表示是否被翻，一个int值表示具体的值。</p>
<h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><p>采用经典的2-SAT算法模型构图，把每个单元格拆成两个点，必雷点\(x\)和非雷点\(x’\)，对于每个逻辑判断添加有向边：</p>
<ol>
<li>\(x必为雷\Longleftrightarrow添加x’\to x边\)（学过离散数学的应该明白这句话与\(x’=false\)等价）</li>
<li>\(x非雷\Longleftrightarrow添加x\to x’边\)</li>
<li>\(若x为雷，则y非雷\Longleftrightarrow添加x\to y’边\)</li>
<li>\(若x非雷，则y为雷\Longleftrightarrow添加x’\to y边\)</li>
</ol>
<p>构图后依次判断每个未知块：</p>
<ol>
<li>\(x\to x’可达\Longleftrightarrow x=false\)，即非雷</li>
<li>\(x’\to x可达\Longleftrightarrow x’=false\)，即必雷</li>
</ol>
<p>实践发现高级模式计算时间基本都在1秒之内，所以算法时空复杂度的计算意义不大，但出于对算法的尊重，还是初步估算一下。</p>
<h5 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><p>用N表示单元格的总数，由于最后需要判断每个x和x’的连通性以及x’和x的联通性，外层复杂度为N，判断联通性时可用数组标记访问过的点，因此最多需要经过所有点N，每次局面分析的时间复杂度为\(O(N^2)\)。考虑最多需要N次局面分析，则最坏时间复杂度为\(O(N^3)\)。</p>
<h5 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h5><p>考虑用邻接表存储图的复杂度为\(O(V+E)\)，但考虑的边数是由顶点数决定的，一个数字块最多可能产生16条推断式，即16条边，虽然很大，但也是个常数，所以总时间复杂度为\(O(N)\)。</p>
<h4 id="单元格识别"><a href="#单元格识别" class="headerlink" title="单元格识别"></a>单元格识别</h4><p>通过相关API获取扫雷窗口句柄，再通过一系列小实验得出各单元格在扫雷窗口中的相对位置和数字、空格、未知块在几个特征像素点上的RGB值。</p>
<p>需要注意的是Win32的API中每个GetDC之后需要DeleteDC，否则程序长时间运行后容易出现RGB值读取错误的情况，推测是每个GetDC都需要分配空间，若不Delete则在程序结束后才释放，导致分配给进程的内存不足，这个坑了我久。</p>
<h4 id="点击效果"><a href="#点击效果" class="headerlink" title="点击效果"></a>点击效果</h4><p>在实现时用左键双击代替单击，因为鼠标的单击效果只有在焦点指定在当前窗口时有效，否则第一次单击只能改变焦点窗口，而无法形成翻块效果。</p>
<h4 id="主要代码"><a href="#主要代码" class="headerlink" title="主要代码"></a>主要代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> ROWS = <span class="number">9</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> COLUMNS = <span class="number">9</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MINES = <span class="number">10</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> DIRECTIONS = <span class="number">8</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> VERTEXS = (ROWS * COLUMNS) &lt;&lt; <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> DX[<span class="number">8</span>] = &#123; <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span> &#125;;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> DY[<span class="number">8</span>] = &#123; <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</div><div class="line">RECT rect;</div><div class="line"><span class="function">COLORREF <span class="title">GetColor</span><span class="params">(Point p)</span> </span>&#123;</div><div class="line">	HDC hdc = ::GetDC(<span class="literal">NULL</span>);</div><div class="line">	COLORREF color = GetPixel(hdc, p.x, p.y);</div><div class="line">	DeleteDC(hdc);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> x, y;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">isValid</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; x &lt; ROWS &amp;&amp; y &lt; COLUMNS;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Click</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> X = y, Y = x;</div><div class="line">		<span class="keyword">int</span> beginX = rect.left + <span class="number">16</span> + X * <span class="number">16</span>;</div><div class="line">		<span class="keyword">int</span> beginY = rect.top + <span class="number">102</span> + Y * <span class="number">16</span>;</div><div class="line">		SetCursorPos(beginX + <span class="number">7</span>, beginY + <span class="number">7</span>);</div><div class="line">		mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">		mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">		Sleep(<span class="number">200</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">GetVertexID</span><span class="params">(<span class="keyword">bool</span> isMine)</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> (x * COLUMNS + y) &lt;&lt; <span class="number">1</span> | isMine;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line">struct Cell &#123;</div><div class="line">	Point point;</div><div class="line">	bool isCovered;</div><div class="line">	int value;</div><div class="line">	bool isCoveredAndSafe() &#123;</div><div class="line">		return point.isValid() &amp;&amp; isCovered &amp;&amp; value == 1;</div><div class="line">	&#125;</div><div class="line">	bool isCoveredAndUnknown() &#123;</div><div class="line">		return point.isValid() &amp;&amp; isCovered &amp;&amp; value == 0;</div><div class="line">	&#125;	</div><div class="line">	bool isCoveredAndMine() &#123;</div><div class="line">		return point.isValid() &amp;&amp; isCovered &amp;&amp; value == -1;</div><div class="line">	&#125;</div><div class="line">	bool isUncoveredAndNumber() &#123;</div><div class="line">		return point.isValid() &amp;&amp; !isCovered &amp;&amp; value &gt; 0;</div><div class="line">	&#125;</div><div class="line">	bool UpdateCellValue() &#123;</div><div class="line">		int X = point.y, Y = point.x;</div><div class="line">		int beginX = rect.left + 16 + X * 16;</div><div class="line">		int beginY = rect.top + 102 + Y * 16;</div><div class="line">		COLORREF color = GetColor(Point&#123; beginX, beginY &#125;);</div><div class="line">		if (color == RGB(255, 255, 255)) &#123;</div><div class="line">			isCovered = true;</div><div class="line">			return true;</div><div class="line">		&#125;</div><div class="line">		isCovered = false;</div><div class="line">		COLORREF color = GetColor(Point&#123; beginX + 7, beginY + 7&#125;);</div><div class="line">		switch (color) &#123;</div><div class="line">		case RGB(0, 0, 255):value = 1; return true;</div><div class="line">		case RGB(0, 128, 0):value = 2; return true;</div><div class="line">		case RGB(255, 0, 0):value = 3; return true;</div><div class="line">		case RGB(0, 0, 128):value = 4; return true;</div><div class="line">		case RGB(128, 0, 0):value = 5; return true;</div><div class="line">		case RGB(0, 128, 128):value = 6; return true;</div><div class="line">		case RGB(128, 128, 128):value = 8; return true;</div><div class="line">		case RGB(192, 192, 192): break;</div><div class="line">		default: return false; break;</div><div class="line">		&#125;</div><div class="line">		COLORREF color = GetColor(Point&#123; beginX + 7, beginY + 8 &#125;);</div><div class="line">		if (color == RGB(0, 0, 0)) &#123;</div><div class="line">			value = 7;</div><div class="line">		&#125;</div><div class="line">		else if (color == RGB(192, 192, 192)) &#123;</div><div class="line">			value = 0;</div><div class="line">		&#125;</div><div class="line">		else &#123;</div><div class="line">			return false;</div><div class="line">		&#125;</div><div class="line">		return true;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MineSweeper</span> &#123;</span></div><div class="line">	<span class="built_in">vector</span> &lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; Graph;</div><div class="line">	<span class="built_in">vector</span> &lt;Cell&gt; cells;</div><div class="line">	MineSweeper() &#123;</div><div class="line">		cells.resize(ROWS * COLUMNS);</div><div class="line">		Graph.resize(VERTEXS);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ROWS; ++i) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; COLUMNS; ++j) &#123;</div><div class="line">				cells.at(i * COLUMNS + j) = Cell&#123; Point&#123; i, j &#125;, <span class="literal">true</span>, <span class="number">0</span> &#125;;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function">Cell <span class="title">GetCellStatus</span><span class="params">(Point p)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> index = p.x * COLUMNS + p.y;</div><div class="line">		assert(p.isValid() &amp;&amp; index &gt;= <span class="number">0</span> &amp;&amp; index &lt; cells.size());</div><div class="line">		<span class="keyword">return</span> cells[index];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Check</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCoveredAndSafe()) &#123;</div><div class="line">				cells[i].point.Click();</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"Safe Click: (%d, %d)\n"</span>, cells[i].point.x, cells[i].point.y);</div><div class="line">				++cnt;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> cnt;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">Fetch</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCoveredAndSafe() || cells[i].isCoveredAndUnknown()) &#123;</div><div class="line">				<span class="keyword">if</span> (!cells[i].UpdateCellValue()) &#123;</div><div class="line">					<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AddEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">		assert(u &gt;= <span class="number">0</span> &amp;&amp; v &gt;= <span class="number">0</span> &amp;&amp; u &lt; VERTEXS &amp;&amp; v &lt; VERTEXS);</div><div class="line">		Graph[u].push_back(v);</div><div class="line">		Point p1&#123; u / <span class="number">2</span> / COLUMNS, u / <span class="number">2</span> % COLUMNS &#125;;</div><div class="line">		Point p2&#123; v / <span class="number">2</span> / COLUMNS, v / <span class="number">2</span> % COLUMNS &#125;;</div><div class="line">		<span class="keyword">bool</span> b1 = (u % <span class="number">2</span> == <span class="number">1</span>), b2 = (v % <span class="number">2</span> == <span class="number">1</span>);</div><div class="line">		<span class="comment">//printf("if (%d, %d) is%sMine, then (%d, %d) is%sMine\n", </span></div><div class="line">			<span class="comment">//p1.x, p1.y, b1 ? " " : " not ", p2.x, p2.y, b2 ? " " : " not ");</span></div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetAdjacentCells</span><span class="params">(Cell cell, <span class="built_in">vector</span>&lt;Point&gt;&amp;mines, <span class="built_in">vector</span>&lt;Point&gt;&amp;unkonwns)</span> </span>&#123;</div><div class="line">		mines.clear();</div><div class="line">		unkonwns.clear();</div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span> (cell.point.x == <span class="number">7</span> &amp;&amp; cell.point.y == <span class="number">6</span>) &#123;</div><div class="line">			++cnt;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DIRECTIONS; ++i) &#123;</div><div class="line">			Point p&#123; cell.point.x + DX[i], cell.point.y + DY[i] &#125;;</div><div class="line">			<span class="keyword">if</span> (p.isValid()) &#123;</div><div class="line">				Cell adj = GetCellStatus(p);</div><div class="line">				<span class="keyword">if</span> (adj.isCoveredAndUnknown()) &#123;</div><div class="line">					unkonwns.push_back(adj.point);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (adj.isCoveredAndMine()) &#123;</div><div class="line">					mines.push_back(adj.point);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">GetAllCells</span><span class="params">(<span class="built_in">vector</span>&lt;Point&gt;&amp;mines, <span class="built_in">vector</span>&lt;Point&gt;&amp;unkonwns)</span> </span>&#123;</div><div class="line">		mines.clear();</div><div class="line">		unkonwns.clear();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCoveredAndUnknown()) &#123;</div><div class="line">				unkonwns.push_back(cells[i].point);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (cells[i].isCoveredAndMine()) &#123;</div><div class="line">				mines.push_back(cells[i].point);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AssertAll</span><span class="params">(<span class="built_in">vector</span>&lt;Point&gt; adjs, <span class="keyword">bool</span> isMine)</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; adjs.size(); ++i) &#123;</div><div class="line">			AddEdge(adjs[i].GetVertexID(!isMine), adjs[i].GetVertexID(isMine));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">AssertIfOneThenElse</span><span class="params">(<span class="built_in">vector</span>&lt;Point&gt; adjs, <span class="keyword">bool</span> isMine)</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; adjs.size(); ++i) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; adjs.size(); ++j) &#123;</div><div class="line">				<span class="keyword">if</span> (i != j) &#123;</div><div class="line">					AddEdge(adjs[i].GetVertexID(isMine), adjs[j].GetVertexID(!isMine));</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Reason</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="built_in">vector</span>&lt;Point&gt;mines, unkonwns;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VERTEXS; ++i) &#123;</div><div class="line">			Graph[i].clear();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isUncoveredAndNumber()) &#123;</div><div class="line">				GetAdjacentCells(cells[i], mines, unkonwns);</div><div class="line">				assert(cells[i].value - mines.size() &gt;= <span class="number">0</span> &amp;&amp; cells[i].value - mines.size() &lt;= unkonwns.size());</div><div class="line">				<span class="keyword">if</span> (cells[i].value - mines.size() == <span class="number">0</span>) &#123;</div><div class="line">					AssertAll(unkonwns, <span class="literal">false</span>);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> (cells[i].value - mines.size() == unkonwns.size()) &#123;</div><div class="line">					AssertAll(unkonwns, <span class="literal">true</span>);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> (cells[i].value - mines.size() == <span class="number">1</span>) &#123;</div><div class="line">					AssertIfOneThenElse(unkonwns, <span class="literal">true</span>);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> (cells[i].value - mines.size() == (<span class="keyword">int</span>)unkonwns.size() - <span class="number">1</span>) &#123;</div><div class="line">					AssertIfOneThenElse(unkonwns, <span class="literal">false</span>);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		GetAllCells(mines, unkonwns);</div><div class="line">		assert(MINES - mines.size() &gt;= <span class="number">0</span> &amp;&amp; MINES - mines.size() &lt;= unkonwns.size());</div><div class="line">		<span class="keyword">if</span> (MINES - mines.size() == <span class="number">0</span>) &#123;</div><div class="line">			AssertAll(unkonwns, <span class="literal">false</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (MINES - mines.size() == unkonwns.size()) &#123;</div><div class="line">			AssertAll(unkonwns, <span class="literal">true</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (MINES - mines.size() == <span class="number">1</span>) &#123;</div><div class="line">			AssertIfOneThenElse(unkonwns, <span class="literal">true</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (MINES - mines.size() == (<span class="keyword">int</span>)unkonwns.size() - <span class="number">1</span>) &#123;</div><div class="line">			AssertIfOneThenElse(unkonwns, <span class="literal">false</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">isAccessible</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (u == v) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">queue</span> &lt;<span class="keyword">int</span>&gt; q;</div><div class="line">		<span class="built_in">vector</span> &lt;<span class="keyword">bool</span>&gt; vis(VERTEXS, <span class="literal">false</span>);</div><div class="line">		q.push(u);</div><div class="line">		vis[u] = <span class="literal">true</span>;</div><div class="line">		<span class="keyword">while</span> (!q.empty()) &#123;</div><div class="line">			<span class="keyword">int</span> t = q.front();</div><div class="line">			q.pop();</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Graph[t].size(); ++i) &#123;</div><div class="line">				<span class="keyword">if</span> (vis[Graph[t][i]] == <span class="literal">false</span>) &#123;</div><div class="line">					<span class="keyword">if</span> (Graph[t][i] == v) &#123;</div><div class="line">						<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">					&#125;</div><div class="line">					q.push(Graph[t][i]);</div><div class="line">					vis[Graph[t][i]] = <span class="literal">true</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">Judge</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; VERTEXS; ++i) &#123;</div><div class="line">			unique(Graph[i].begin(), Graph[i].end());</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCoveredAndUnknown()) &#123;</div><div class="line">				<span class="keyword">if</span> (isAccessible(cells[i].point.GetVertexID(<span class="literal">true</span>), cells[i].point.GetVertexID(<span class="literal">false</span>))) &#123;</div><div class="line">					flag = <span class="literal">true</span>;</div><div class="line">					cells[i].value = <span class="number">1</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span> <span class="keyword">if</span> (isAccessible(cells[i].point.GetVertexID(<span class="literal">false</span>), cells[i].point.GetVertexID(<span class="literal">true</span>))) &#123;</div><div class="line">					flag = <span class="literal">true</span>;</div><div class="line">					cells[i].value = <span class="number">-1</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> flag;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">FindAllMines</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCoveredAndMine()) &#123;</div><div class="line">				++cnt;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		assert(cnt &lt;= MINES);</div><div class="line">		<span class="keyword">return</span> cnt == MINES;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">RandomClick</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="built_in">vector</span>&lt;Point&gt; mines, unknowns;</div><div class="line">		GetAllCells(mines, unknowns);</div><div class="line">		<span class="keyword">if</span> (unknowns.size() == <span class="number">0</span>) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">		&#125;</div><div class="line">		srand(time(<span class="number">0</span>));</div><div class="line">		<span class="keyword">int</span> r = rand() % unknowns.size();</div><div class="line">		unknowns[r].Click();</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Random Click: (%d, %d)\n"</span>, unknowns[r].x, unknowns[r].y);</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">Print</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cells.size(); ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (cells[i].isCovered) &#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"?"</span>);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%d"</span>, cells[i].value);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (i % COLUMNS == COLUMNS - <span class="number">1</span>) &#123;</div><div class="line">				<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>神奇地发现markdown无法渲染switch-case关键字。。。</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>之前写的代码太挫，于是又重构了一遍，看得顺眼了一点。</p>
<p>试着拿着代码去xp的扫雷下面跑，惊奇地发现扫雷在win10下和xp下的单元格相对位置是不一样的，差1到2个像素点！更惊奇地发现Win32获取屏幕某个点RGB值的API在两个操作系统下的效率有着肉眼可见的时间差（大约100倍吧），大xp完胜！<br>另外xp的扫雷和win10的难度也是有差别的：同样的代码win10跑了1个半小时终于跑出一把高级，而xp下基本每5分钟就能出一把。这并不是识别模块效率的锅，而是xp下的中后期很稳，翻开大部分基本就赢定了，而win10到后面总会有那种靠人品的局面，而且这种局面下往往都是猜错的。不知这其中有没有啥不可描述的猫腻。</p>
<p>唯一的遗憾是数学能力实在有限，无法实现概率扫雷。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://www.matrix67.com/blog/archives/544" target="_blank" rel="external">经典证明：扫雷是NP完全问题</a></p>
<p><a href="http://www.cnblogs.com/ambition/archive/2011/09/22/Mine-sweeping.html" target="_blank" rel="external">解扫雷 - 2-sat新用法</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/23/Talk about Shuping Yang‘s speech/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuenene">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xuenene.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路 | Journey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/23/Talk about Shuping Yang‘s speech/" itemprop="url">Talk About Shuping Yang's Speech</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-23T04:03:00+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Talk About <a href="https://www.youtube.com/watch?v=zMLCcP9yakU" target="_blank" rel="external">Shuping Yang’s Speech</a>.</p>
<p>Free Speech and Limited Internet in China are two controversial issues which confused me a lot when I was a middle school student. Now, I really realize that realistic societies, even those so-called modern societies, are never flawless. America makes no exception. Every society has its own “Political Correctness”, which rules the citizens as latent laws and makes the minority feel uneasy, such as Yang in China and Minorities like Muslims in America. I can’t imagine that a human society can set up a perfect “Political Correctness” taking every citizen into account. Maybe a robot society can do it.</p>
<p>Of course, Yang has right to express her own perspectives about her motherland. However, the thing is not as simple as it looks like - some of the “facts” she told are really ridiculous. Kunming, her birthplace, is one of the cleanest cities in China, and the air in Kunming is fresher than many American cities. Why she wore face masks there every day? Maybe she really got a strange illness - without face masks, she can’t breathe. The most terrible is the opinions she has shared seemed to flatter the deeply prejudiced people who has never been to China, trying to gain their respect or something else. Is that a typical peer pressure? Study, skills and striving - various ways she can choose to get the same quantities of respect, however she chose the most disgraceful but the cheapest way - told lies and showed them that she had been completely assimilated.</p>
<p>What impressed me most these years is that everything has two sides, and every rule has its beneficiaries and unbeneficiaries(I can’t find this word in dictionary, but you know what I mean). If you are one of the unlucky unbeneficiaries, try to obey it and adapt to it. Since prejudice makes us blind at some time, and the most awful things we think are always not as bad as we can see on the surface. If you try your best but fail to adapt to it or find it really terrible, don’t complain it like a coward, strive to conquer it even change it like a man.</p>
<p>All above is also what I want to say to myself five years ago - when I was a middle school student with deep hatred to the examination-oriented education in China.</p>
<p>I’m Yuwei Wang, proud of China.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/22/LeetCode(1-4)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuenene">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xuenene.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路 | Journey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/22/LeetCode(1-4)/" itemprop="url">LeetCode(1-4)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-22T13:51:44+08:00">
                2016-03-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default">
</script>

<p>Sorry for my poor English.</p>
<h3 id="1-Two-Sum-Easy"><a href="#1-Two-Sum-Easy" class="headerlink" title="#1. Two Sum (Easy)"></a>#1. Two Sum (Easy)</h3><h4 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h4><p>Given an array of integers, return indices of the two numbers such that they add up to a specific target.<br>You may assume that each input would have exactly one solution.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>Given nums = [2, 7, 11, 15], target = 9,<br>Because nums[0] + nums[1] = 2 + 7 = 9,<br>return [0, 1].</p>
<h4 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h4><p>Of course you can use “double loop” to solve this problem easily, and the time complexity of this solution is \(O(N^2)\). More efficiently, for each number, you can also use “map” to find out the rest of target in \(O(\log_2N)\) time complexity, so the time complexity of the second solution is \(O(NlogN)\). If you don’t want to use map, you can use an \(O(N\log_2N)\) time complexity algorithm to get the answer after sorting.</p>
<ol>
<li>Initialize two indices – one indexes the first number(index1), and the other indexes the last(index2).</li>
<li>Make a comparison between the target and the sum of the two indexed number.</li>
</ol>
<p>Since the the time complexity of quick sort is \(O(N\log_2N)\), the time complexity of this solution is \(O(N\log_2N)\).</p>
<h4 id="cpp-code"><a href="#cpp-code" class="headerlink" title="cpp_code"></a>cpp_code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</div><div class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></div><div class="line">        <span class="keyword">int</span> num, id;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;other) <span class="keyword">const</span> &#123;</div><div class="line">            <span class="keyword">return</span> num &lt; other.num;</div><div class="line">        &#125;</div><div class="line">    &#125;p[MAXN];</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; twoSum(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;nums, <span class="keyword">int</span> target) &#123;</div><div class="line">        <span class="keyword">int</span> len = nums.size();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; ++i) &#123;</div><div class="line">            p[i].num = nums[i];</div><div class="line">            p[i].id = i;</div><div class="line">        &#125;</div><div class="line">        sort(p, p + len);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j = len - <span class="number">1</span>; i &lt; j; ) &#123;</div><div class="line">            <span class="keyword">if</span>(p[i].num + p[j].num == target) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&#123;p[i].id, p[j].id&#125;;</div><div class="line">            &#125;</div><div class="line">            p[i].num + p[j].num &gt; target? --j: ++i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="2-Add-Two-Numbers-Medium"><a href="#2-Add-Two-Numbers-Medium" class="headerlink" title="#2. Add Two Numbers (Medium)"></a>#2. Add Two Numbers (Medium)</h3><h4 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h4><p>You are given two linked lists representing two non-negative numbers. The digits are stored in reverse order and each of their nodes contain a single digit. Add the two numbers and return it as a linked list.</p>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><p>Input: (2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)</p>
<p>Output: 7 -&gt; 0 -&gt; 8</p>
<h4 id="Analysis-1"><a href="#Analysis-1" class="headerlink" title="Analysis"></a>Analysis</h4><p>Have you ever solved the problem of “Big Number A + B” ? Solve it in the same way. Link-List may be more difficult than array, be careful. Actually, the input gives two reversed strings of number, which makes the problem easier, so you don’t need to reverse it again.</p>
<h4 id="cpp-code-1"><a href="#cpp-code-1" class="headerlink" title="cpp_code"></a>cpp_code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Definition for singly-linked list.</div><div class="line"> * struct ListNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     ListNode *next;</div><div class="line"> *     ListNode(int x) : val(x), next(NULL) &#123;&#125;</div><div class="line"> * &#125;;</div><div class="line"> */</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">	<span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> temp = l1-&gt;val + l2-&gt;val;</div><div class="line">		ListNode *root = <span class="keyword">new</span> ListNode(temp % <span class="number">10</span>);</div><div class="line">		ListNode *p = root;</div><div class="line">		<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">			<span class="keyword">if</span> (l1-&gt;next != <span class="literal">NULL</span> &amp;&amp; l2-&gt;next != <span class="literal">NULL</span>) &#123;</div><div class="line">				l1 = l1-&gt;next;</div><div class="line">				l2 = l2-&gt;next;</div><div class="line">				temp = l1-&gt;val + l2-&gt;val + temp / <span class="number">10</span>;</div><div class="line">				p-&gt;next = <span class="keyword">new</span> ListNode(temp % <span class="number">10</span>);</div><div class="line">				p = p-&gt;next;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (l1-&gt;next != <span class="literal">NULL</span> &amp;&amp; l2-&gt;next == <span class="literal">NULL</span>) &#123;</div><div class="line">				l1 = l1-&gt;next;</div><div class="line">				temp = l1-&gt;val + temp / <span class="number">10</span>;</div><div class="line">				p-&gt;next = <span class="keyword">new</span> ListNode(temp % <span class="number">10</span>);</div><div class="line">				p = p-&gt;next;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (l1-&gt;next == <span class="literal">NULL</span> &amp;&amp; l2-&gt;next != <span class="literal">NULL</span>) &#123;</div><div class="line">				l2 = l2-&gt;next;</div><div class="line">				temp = l2-&gt;val + temp / <span class="number">10</span>;</div><div class="line">				p-&gt;next = <span class="keyword">new</span> ListNode(temp % <span class="number">10</span>);</div><div class="line">				p = p-&gt;next;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">if</span>(temp / <span class="number">10</span>) &#123;</div><div class="line">					p-&gt;next = <span class="keyword">new</span> ListNode(temp / <span class="number">10</span>);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> root;</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="3-Longest-Substring-Without-Repeating-Characters-Medium"><a href="#3-Longest-Substring-Without-Repeating-Characters-Medium" class="headerlink" title="#3 Longest Substring Without Repeating Characters (Medium)"></a>#3 Longest Substring Without Repeating Characters (Medium)</h3><h4 id="Decription"><a href="#Decription" class="headerlink" title="Decription"></a>Decription</h4><p>Given a string, find the length of the longest substring without repeating characters. For example, the longest substring without repeating letters for “abcabcbb” is “abc”, which the length is 3. For “bbbbb” the longest substring is “b”, with the length of 1.</p>
<h4 id="Analysis-2"><a href="#Analysis-2" class="headerlink" title="Analysis"></a>Analysis</h4><p>The obvious solution is to check every substring is legal or not. The time complexity of enumeration is \(O(N^2)\). You can find that some substring is unnecessary to check. For instance, “abcabcbb”, when you find that the substring “cabc” is illegal, you can also assert that the substring “bcsbc” which has the substring “cabc” is also illegal, “cabcb” is alike. So you are only required to check the substring whose first character and last character are same, and the others are unique.</p>
<ol>
<li>Initialize two indices to indict the current substring. One indexes the begin(index1), and the other indexes the end(index2 + 1).</li>
<li>Build a hash-array to record the current location of each character, 256-Length is enough. Record -1 indicts that character is out of current substring.</li>
</ol>
<h4 id="cpp-code-2"><a href="#cpp-code-2" class="headerlink" title="cpp_code"></a>cpp_code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">	<span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">256</span>;</div><div class="line">	<span class="keyword">int</span> mhash[MAXN];</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> len = s.length();</div><div class="line">		<span class="built_in">memset</span>(mhash, <span class="number">-1</span>, <span class="keyword">sizeof</span>(mhash));</div><div class="line">		<span class="keyword">int</span> p1 = <span class="number">0</span>, ans = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> p2 = <span class="number">0</span>; p2 &lt; len; ++p2) &#123;</div><div class="line">			<span class="keyword">if</span> (mhash[s[p2]] != <span class="number">-1</span>) &#123;</div><div class="line">				ans = max(ans, p2 - p1);</div><div class="line">				<span class="keyword">for</span> (; p1 &lt;= mhash[s[p2]]; ++p1) &#123;</div><div class="line">					mhash[s[p1]] = <span class="number">-1</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			mhash[s[p2]] = p2;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> max(ans, len - p1);</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="4-Median-of-Two-Sorted-Arrays-Hard"><a href="#4-Median-of-Two-Sorted-Arrays-Hard" class="headerlink" title="#4. Median of Two Sorted Arrays (Hard)"></a>#4. Median of Two Sorted Arrays (Hard)</h3><h4 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h4><p>There are two sorted arrays nums1 and nums2 of size m and n respectively. Find the median of the two sorted arrays. The overall run time complexity should be \(O(\log_2(M+N))\)</p>
<h4 id="Analysis-3"><a href="#Analysis-3" class="headerlink" title="Analysis"></a>Analysis</h4><p>Your can use quick sort to resort the union of the two arrays, then return the median, the complexity of this solution is<br>\(O((M+N)\log_2(M+N))\)</p>
<p>More efficiently, since the arrays are ordered, you<br>can merge these two arrays in<br>\(O(M+N)\) time complexity, like a sub-operation of merge sort. These two solutions both can get an ordered union array, then return the median as the problem describing.</p>
<p>Here is a solution in \(O(\log_2M*\log_2N)\) time complexity.</p>
<ol>
<li>Assume that the volume of union of two arrays is an odd number, we can easy to assert that there must be a number in nums1 or nums2 which can be the median of union. So, find out it!</li>
<li>Assume that the median is in nums1.</li>
<li>Binary search the quasi-median in nums1, then check nums2 (also a binary-search) and sum up the total number of the union’s element which would be the left of the quasi-median(smaller than quasi-median), calculate the right ones(larger than quasi-median).</li>
<li>Compare the number of left with the number of right.</li>
<li>If the median is not in nums1, swap the position of nums1 and nums2, do double-loop binary-search again. That is to say, assume that the median is in nums2, search its quasi-position in nums1.</li>
<li>It’s a little difficult when the volume of union is an even number. There must be two numbers to define the median. So we should find out these two numbers.</li>
<li>We can solve it in a similar way as an odd volume.</li>
<li>If the leftMedian and rightMedian are not both definite, record the definite one and do it again after swapping.</li>
<li>However, the above solution only considered that each number in the union is unique. Do some little trick as the following code showing.</li>
</ol>
<h4 id="cpp-code-3"><a href="#cpp-code-3" class="headerlink" title="cpp_code"></a>cpp_code</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">isMedian</span><span class="params">(<span class="keyword">int</span> index1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> n1 = nums1.size(), n2 = nums2.size();</div><div class="line">		<span class="keyword">int</span> index2 = upper_bound(nums2.begin(), nums2.end(), nums1[index1]) - nums2.begin();</div><div class="line">		<span class="keyword">int</span> le1 = index1 + index2, ri1 = n1 + n2 - le1 - <span class="number">1</span>;</div><div class="line">		index2 = lower_bound(nums2.begin(), nums2.end(), nums1[index1]) - nums2.begin();</div><div class="line">		<span class="keyword">int</span> le2 = index1 + index2, ri2 = n1 + n2 - le2 - <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (le1 - ri1 &gt;= <span class="number">0</span> &amp;&amp; le2 - ri2 &lt;= <span class="number">0</span>) &#123;</div><div class="line">		    <span class="keyword">if</span>((le1 - ri1) &amp; <span class="number">1</span>) &#123;</div><div class="line">		        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		    &#125;</div><div class="line">			<span class="keyword">return</span> (n1 + n2) &amp; <span class="number">1</span> ^ <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="built_in">abs</span>(le1 - ri1) &lt; <span class="built_in">abs</span>(le2 - ri2) ? le1 - ri1 : le2 - ri2;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">oddCheck</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> le = <span class="number">0</span>, ri = nums1.size() - <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> (; le &lt;= ri;) &#123; <span class="keyword">int</span> mid = ((le + ri) &gt;&gt; <span class="number">1</span>);</div><div class="line">			<span class="keyword">int</span> ret = isMedian(mid, nums1, nums2);</div><div class="line">			<span class="keyword">if</span> (ret &gt; <span class="number">0</span>) &#123;</div><div class="line">				ri = mid - <span class="number">1</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (ret &lt; <span class="number">0</span>) &#123;</div><div class="line">				le = mid + <span class="number">1</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				<span class="keyword">return</span> mid;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">evenCheck</span><span class="params">(pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&amp; ans, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> le = <span class="number">0</span>, ri = nums1.size() - <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> (; le &lt;= ri;) &#123; <span class="keyword">int</span> mid = ((le + ri) &gt;&gt; <span class="number">1</span>);</div><div class="line">			<span class="keyword">int</span> ret = isMedian(mid, nums1, nums2);</div><div class="line">			<span class="keyword">if</span> (ret &gt; <span class="number">0</span>) &#123;</div><div class="line">				ri = mid - <span class="number">1</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (ret &lt; <span class="number">0</span>) &#123;</div><div class="line">				le = mid + <span class="number">1</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">			    ans.first = ans.second = nums1[mid];</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(ret == <span class="number">1</span>)&#123;</div><div class="line">				ans.first = nums1[mid];</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (ret == <span class="number">-1</span>) &#123;</div><div class="line">				ans.second = nums1[mid];</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(ans.first != <span class="number">-1</span> &amp;&amp; ans.second != <span class="number">-1</span>) &#123;</div><div class="line">			    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</div><div class="line">		<span class="keyword">int</span> n1 = nums1.size(), n2 = nums2.size();</div><div class="line">		<span class="keyword">if</span> ((n1 + n2) &amp; <span class="number">1</span>) &#123;</div><div class="line">			<span class="keyword">int</span> index1 = oddCheck(nums1, nums2);</div><div class="line">			<span class="keyword">if</span> (index1 != <span class="number">-1</span>) &#123;</div><div class="line">				<span class="keyword">return</span> nums1[index1];</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> nums2[oddCheck(nums2, nums1)];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pr(<span class="number">-1</span>, <span class="number">-1</span>);</div><div class="line">			<span class="keyword">bool</span> ans = evenCheck(pr, nums1, nums2);</div><div class="line">			<span class="keyword">if</span> (ans == <span class="literal">false</span>) &#123;</div><div class="line">				evenCheck(pr, nums2, nums1);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> (pr.first + pr.second) / <span class="number">2.0</span>;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/15/谈谈反智主义/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuenene">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xuenene.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路 | Journey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/15/谈谈反智主义/" itemprop="url">谈谈反智主义</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-15T04:23:44+08:00">
                2016-02-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>曾经对某些可用一些现象描述的社会群体性意识无法用简单的语言概括，直到我看到了这一个词——<a href="https://zh.wikipedia.org/wiki/%E5%8F%8D%E6%99%BA%E4%B8%BB%E4%B9%89" target="_blank" rel="external">反智主义（anti-intellectualism）</a>。</p>
<p>反智主义最广义的表现形式是对传统深信不疑、对未知世界的不屑以及读书无用论。</p>
<p>时常听到人们抱怨国家大力发展高科技而忽略民生，许多贫困山区的人饭都吃不饱。远的不谈，就谈最近被官方确认的“引力波”，也被许多人质疑发现这种“虚无缥缈”的东西的必要性。其实早在100多年前，麦克斯韦发现电磁波时也受到过类似质疑。</p>
<p>听够了民间的声音，再来看看NASA的官方态度：<a href="http://www.nasa.gov/missions/solarsystem/Why_We_01pt1.html" target="_blank" rel="external"><em>The Importance of Exploration &amp; Why We Explore</em></a></p>
<p>尝试着译了其中的几段。</p>
<p><strong>原文：</strong></p>
<blockquote>
<p><em>As historian Stephen J. Pyne has argued, “Exploration is a specific invention of specific civilizations conducted at specific historical times. It is not … a universal property of all human societies. Not all cultures have explored or even traveled widely. Some have been content to exist in xenophobic isolation.”</em></p>
<p><em>There is a value judgment in that last sentence – that xenophobia and isolation are bad, but that they are in fact bad, I think, is borne out by history. The case most often cited for a societal decision not to explore – with generally recognized bad effects – is Ming China in the 15th century. You will find this case, for example, made in Bob Zubrin’s books on Mars, and before that made by NASA Administrator James Beggs. Is it hype, or is it history?</em></p>
<p><em>The historical facts are quite clear. Historian Daniel Boorstin – the recently deceased Librarian of Congress – pointed out that in the early 15th century the biggest Chinese ships were up to ten times the size of Columbus’s later in the century. While Columbus had 17 ships and 1500 men on the largest of his four expeditions, the Chinese Admiral Zheng He had 317 ships and 27,000 crewmen on the first of his six expeditions. Following a maritime tradition stretching back to the 11th century, from 1405-1433, these ships plied the seas of Southeast Asia, sailed to India, the Persian Gulf, the Red Sea and down the East Coast of Africa.</em></p>
<p><em>But what is important is this. Although Chinese state revenues were probably 100 times Portugal’s, after the 1430s the Ming emperors had other priorities, and it was the Portuguese and other European countries that led the way in exploration. As Boorstin noted “When Europeans were sailing out with enthusiasm and high hopes, land-bound China was sealing her borders. Within her physical and intellectual Great Wall, she avoided encounter with the unexpected …. Fully equipped with the technology, the intelligence, and the national resources to become discoverers, the Chinese doomed themselves to be discovered.”</em></p>
<p><em>In their recent world history, historians J. R. and William McNeill come to the same conclusions, and historians in general tend to agree that the Chinese chose poorly in the mid-15th century. By the 1470s, the McNeils wrote, even the skills needed to build great ships were lost. Boorstin called the withdrawal of the Chinese into their own borders, symbolized by the Great Wall of China that took its current form at that time, “catastrophic … with consequences we still see today.” The parallel with what is happening now, despite renewed attempts at space exploration, is striking. Some day historians will be writing about whether or not WE chose wisely, not only to make a proposal to explore, but also to fund it.</em></p>
</blockquote>
<p><strong>译文：</strong></p>
<blockquote>
<p><em>历史学家Stephen J. Pyne称，“科学探索是在特定历史背景下的特定文明所催生出的一种特殊创造力。它不是所有人类社会普遍意义上的共同财富。并不是所有的文化都愿意进行广泛的科学探索。一些文化则满足于盲目排外而孤立存在。”</em></p>
<p><em>上文最后一句话中有一个价值观的判断——我认为盲目排外而孤立存在是不好的，历史证明事实上的确如此。一个社会决定不再进行科学探索后将会产生一些坏的影响，这些影响已经被世界所公认。一个经常被拿来援引的例子——15世纪的中国明朝。很多地方都能看到这个例子，如Bob Zubrin的书中，在这之前，NASA的管理者James Beggs也提及过。这是炒作吗？或者说这是历史吗？</em></p>
<p><em>历史事实是相当明朗的。历史学家Daniel Boorstin——已故前美国国会图书馆馆长——指出在15世纪初，中国最大的船的尺寸几乎十倍于世纪末哥伦布的船。哥伦布的四次远征中最大的一次带领了17艘船和1500个男性，而中国的舰队指挥官郑和在六次远征中的第一次便拥有317艘船和27000多个舰员。追溯那段从11世纪流传下来的航海历史，在1405-1433年间，这些船往返东南亚的海上，航行到印度，波斯湾，红海，再到非洲的东海岸。</em></p>
<p><em>当时中国的国家收入几乎百倍于葡萄牙，但在15世纪30年代，明朝皇帝将重心放于其他方向，也正是此后，葡萄牙及欧洲列国开始了他们对世界的探索。正如Boorstin所说，“当欧洲人正在带着热情和希望远航时，固步自封的中国则愈加封锁了他的疆域。其自恃聪明地修筑了长城作为物理屏障，以此极力避免遭遇一切不可预料的事情……在技术、智力和国家资源等方面拥有着可成为发现者的得天独厚的条件，但中国人宣判了自己只能作为被发现的一方。”</em></p>
<p><em>历史学家J. R. 和William McNeill得出一个共同的结论———在近代世界史中，中国在15世纪中期选择了一条不明智的道路——这个结论也得到了大部分历史学家的认同。McNeils称，1470年左右，中国人甚至连造大型轮船的技能都失去了。Boorstin称自从中国的长城形成如今的形态之时，中国人开始撤回到自己的疆域内，“这是灾难性的……之后的结果我们现在仍能看到。”与之形成对比的是现在的中国努力进行着太空探索，效果是很显著的。未来的某一天，历史学家们将写道，曾经的我们为什么没有做出明智的选择——不仅应该制定一个关于研究的协议，还应该大力资助它。</em></p>
</blockquote>
<p>改善民生固然重要，它是国家和社会维持稳定的基石，其人文意义和社会意义较重。而科技发展则是推动社会进步的强力发动机，没有它，我们或许就会像亿万年前的恐龙一样，除了化石，什么也没留下。</p>
<p>我们从小被灌输要好好读书，只有读书才能出人头地的思想。这似乎是个不错的开端。但显然，在现阶段的中国，大部分人对学习的追求倒不如说是一种对学历的偏执。换句话说，如果学历可以无差别地用金钱购买，相信没多少人再愿意静下心来去读书学习。</p>
<p>大学的毛概课没去上过几节，但有一次老师的话让我印象颇深：“我知道你们中大部分人都不信马列主义那一套，但你们知道自己信奉什么主义吗？如果你们答不出来那我就知道了，你们信的是实用主义。大部分实用主义者都说不清自己的想法，什么对我有利我就做什么。譬如你们大部分人都不喜欢这门课但还是来上课了，是因为我要点名。如果我说期末大家都满分，估计就没多少人来上课了。所以很多人并不是来读书的，而是来混学历的。”老师口中的实用主义大概便是利己主义之意。利己主义本身无可厚非，且正是《国富论》中所谈及的“市场经济蓬勃发展之源泉”，殊不知学历仅仅给了我们生存的资本，而这些经历才能引导我们走向理想中的世界。</p>
<p>尽管国人对学历如此看重，国民整体素质还是不容乐观。有人大致统计过，中国（大陆）人的平均知识水平在初中阶段。也难怪时常听到“数学/英语滚出高考”的声音，甚至还被炒成了微博热门。犹记得一条关于“七成网民赞成将数学踢出高考”的犀利评论：数学就是用来将这七成人筛出去的。这种说法似乎过于偏激和略不友善，可恰恰说明了民意是盲目的，并不能驱动社会朝更好的方向发展，改变社会进程的总是少数人，也说明了独立思考能力是成为一个能产生社会价值的人的必要条件。当然网民的意见仅仅是民意的一种体现方式，其并不能准确代表民意，因为网上存在着大量无民事行为能力人，且大部分网民都处于社会底层。中国人缺很多东西，最不缺的就是满口正义无所事事的键盘侠——他们从不想为社会或者周围的人做出些什么，但却总想要社会朝着他们理想的方向发展。</p>
<p>许多小概率事件被当成了颠簸不破的真理：博士生给初中肄业生打工，某人吸烟酗酒活了100岁，小学毕业生一跃成为亿万富豪……一半是“我一朋友/同学”干的，另一半是新闻看的。这些莫须有的朋友和奇闻异事成了许多人怒刷存在感的必备工具，且基于此的谈话除了放大这些幸存者偏差之外往往创造不了任何价值——你不会去谈论那些不读书不工作混了半辈子的朋友，同样媒体也不会报道那些司空见惯的平常事。这么看来似乎是媒体朋友给这歪风添了一阵邪气。为了给百姓茶余饭后的谈话加点佐料，真是无所不用其极。</p>
<p>以色列几乎与中国同时建国（1948年成立），此前没有任何政治基础且自然资源极度贫瘠，但其高等教育普及率高居世界第二，仅次于加拿大（3日本，4美国，5新西兰，6韩国……）。犹太人固然聪明，但中国人的智慧也是世界公认的，只是很多人把聪明用错了地方。他们往往觉得抖机灵的比认真搞学术的要厉害。为此他们不得不刻意编出各种段子来作为对知识分子的嘲讽。</p>
<p><img src="/img/1/1.png" alt="image"></p>
<p>且不论段子中所说的阻力、重力、加速度等基础概念是属于初中的还是高中的，博士生是否会为如此问题讨论良久，光是题中所给的“自由落体”的概念我想段子作者都没搞清楚——难以理解如此常识匮乏的段子为什么会引发众人的转发，空虚的他们用自己的无知去讽刺知识分子，这算不算得上是另一种讽刺？如果这仅仅是一条段子也就罢了，大家一笑而过，并不去和一条段子较真，可一些转发的评论中的意思似乎并不只有调侃那么简单——他们或许并没有独立思考的能力，只是想和大多数人站在一起，以缓解某些方面的自卑所带来的压力。</p>
<p>其实，猫猫狗狗，包括咸鱼，也喜欢和大多数同类待在一起。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/25/CodeForces(340_2)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xuenene">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/xuenene.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="路 | Journey">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/25/CodeForces(340_2)/" itemprop="url">CodeForces 340 (Div. 2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-01-25T00:35:00+08:00">
                2016-01-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default">
</script>

<p>好久没刷题了，心血来潮想来一发Codeforces，提前10小时报了名试试水，但还是不出意料地把这件事给忘了。。。</p>
<p>好吧，既然决定要做就补起来吧。</p>
<p>很顺利地秒了ABCD。一开始被D题吓到了，以为是N个点，没有一点想法，本以为自己回到大二水平还是只能做前三道。突然发现找不到N的范围，不对啊，Codefoces一向以严谨著称从不会犯这种低级错误，这时瞄到了一个醒目的的 Three。。。顿时觉得这题就是B题的难度，没想通为什么放那么后面。</p>
<p>前四道都挺水，这不禁让我开始怀疑Codeforces难度是不是大大调低了。在我本想顺顺利利地AK时E题的出现奠定了一个悲伤的基调。想找一个在线的算法，不出意料地失败了。只写过线段树的数据结构弱渣表示这或许要用一个很碉堡的数据结构来维护，唯一比较确定的是前缀xor和后缀xor应该有用。</p>
<p>走投无路去搜题解，发现不是很多，基本只做了前四道，只有一个隐隐提到了“莫队算法”，但是没贴题解。好吧，又是一个总是听到但是没去看过的算法。</p>
<p>于是这次打算把这个算法看一看，至少了解一下把题给做了。</p>
<p>看懂了大概原理，但是发现编程复杂度很高，于是找了个时间复杂度接近的算法但是代码不长的参考了下终于水过去了。</p>
<p>从来没正式贴过一份完整的题解，在自己的地盘上让人有了写东西的欲望~</p>
<h3 id="A-Elephant"><a href="#A-Elephant" class="headerlink" title="A. Elephant"></a>A. Elephant</h3><h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><p>大象一次可以走1、2、3、4或5步，告诉你目的地位置，至少几次走到。</p>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>签到题，为了题解完整贴一发代码。</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; x) &#123;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; (x + <span class="number">4</span>) / <span class="number">5</span> &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="B-Chocolate"><a href="#B-Chocolate" class="headerlink" title="B. Chocolate"></a>B. Chocolate</h3><h4 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h4><p>一块巧克力若干个位置上有杏仁，1表示此位置有杏仁，0表示没有，问一共有几种切法保证每段子巧克力上都有且只有一个杏仁。</p>
<h4 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h4><p>乘法原理，每两个1之间可以割一刀。</p>
<h4 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">105</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">int</span> a[MAXN], b[MAXN];</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; a[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</div><div class="line">			<span class="keyword">if</span> (a[i]) &#123;</div><div class="line">				b[cnt++] = i;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (cnt == <span class="number">0</span>) &#123;</div><div class="line">			<span class="built_in">puts</span>(<span class="string">"0"</span>);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; cnt; ++i) &#123;</div><div class="line">			ans *= b[i] - b[i - <span class="number">1</span>];</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="C-Watering-Flowers"><a href="#C-Watering-Flowers" class="headerlink" title="C. Watering Flowers"></a>C. Watering Flowers</h3><h4 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h4><p>有两个喷泉和若干朵花，两个喷泉分别以半径r1和r2洒水，两圆之并必须覆盖所有花，求r1^2+r2^2的最小值。</p>
<h4 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h4><p>一开始想当然贪心做，每朵花都取离它最近的喷泉作为水源，发现样例都过不了。。。不急，数据范围只有2000可以接受\(O(n^2)\)的复杂度。那就暴力吧！假设某朵花作为喷泉1覆盖范围边界上的花，其余花与喷泉1的距离小于等于假定花到喷泉1的距离则由喷泉1接管，其余由喷泉2接管，迭代更新算出最优解。注意0的情况。</p>
<h4 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> INF = (<span class="number">1l</span>l &lt;&lt; <span class="number">60</span>);</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dis_2</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="number">1l</span>l * (x1 - x2)*(x1 - x2) + <span class="number">1l</span>l * (y1 - y2)*(y1 - y2);</div><div class="line">&#125;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dis[MAXN][<span class="number">3</span>];</div><div class="line"><span class="keyword">int</span> x[MAXN], y[MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> N, x1, x2, y1, y2;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2) &#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; x[i] &gt;&gt; y[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</div><div class="line">			dis[i][<span class="number">1</span>] = dis_2(x1, y1, x[i], y[i]);</div><div class="line">			dis[i][<span class="number">2</span>] = dis_2(x2, y2, x[i], y[i]);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ans = INF, r1_2, r2_2;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</div><div class="line">			r1_2 = dis[i][<span class="number">1</span>];</div><div class="line">			r2_2 = <span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; ++j) &#123;</div><div class="line">				<span class="keyword">if</span> (dis[j][<span class="number">1</span>] &gt; dis[i][<span class="number">1</span>]) &#123;</div><div class="line">					r2_2 = max(r2_2, dis[j][<span class="number">2</span>]);</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			ans = min(ans, r1_2 + r2_2);</div><div class="line">		&#125;</div><div class="line">		r2_2 = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</div><div class="line">			r2_2 = max(r2_2, dis[i][<span class="number">2</span>]);</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">cout</span> &lt;&lt; min(ans, r2_2) &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="D-Polyline"><a href="#D-Polyline" class="headerlink" title="D. Polyline"></a>D. Polyline</h3><h4 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h4><p>传说中最水的D题。给定三个点，问花一条至少几段的折线可以将这些点全覆盖，折线不能交叉不能首尾相连，且其每段要与坐标轴平行。</p>
<h4 id="分析-3"><a href="#分析-3" class="headerlink" title="分析"></a>分析</h4><p>分类讨论。</p>
<h4 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> x[<span class="number">3</span>], y[<span class="number">3</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check1</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2, <span class="keyword">int</span> x3, <span class="keyword">int</span> y3)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> x1 == x2&amp;&amp;x1 == x3;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check2</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2, <span class="keyword">int</span> x3, <span class="keyword">int</span> y3)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span> (x1 == x2) &#123;</div><div class="line">		<span class="keyword">return</span> y3 &gt;= max(y1, y2) || y3 &lt;= min(y1, y2);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; x[<span class="number">0</span>]) &#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; y[<span class="number">0</span>] &gt;&gt; x[<span class="number">1</span>] &gt;&gt; y[<span class="number">1</span>] &gt;&gt; x[<span class="number">2</span>] &gt;&gt; y[<span class="number">2</span>];</div><div class="line">		<span class="keyword">if</span> (check1(x[<span class="number">0</span>], y[<span class="number">0</span>], x[<span class="number">1</span>], y[<span class="number">1</span>], x[<span class="number">2</span>], y[<span class="number">2</span>])||</div><div class="line">			check1(y[<span class="number">0</span>], x[<span class="number">0</span>], y[<span class="number">1</span>], x[<span class="number">1</span>], y[<span class="number">2</span>], x[<span class="number">2</span>])) &#123;</div><div class="line">			<span class="built_in">puts</span>(<span class="string">"1"</span>);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (check2(x[<span class="number">0</span>], y[<span class="number">0</span>], x[<span class="number">1</span>], y[<span class="number">1</span>], x[<span class="number">2</span>], y[<span class="number">2</span>]) || </div><div class="line">			check2(x[<span class="number">0</span>], y[<span class="number">0</span>], x[<span class="number">2</span>], y[<span class="number">2</span>], x[<span class="number">1</span>], y[<span class="number">1</span>]) || </div><div class="line">			check2(x[<span class="number">1</span>], y[<span class="number">1</span>], x[<span class="number">2</span>], y[<span class="number">2</span>], x[<span class="number">0</span>], y[<span class="number">0</span>]) ||</div><div class="line">			check2(y[<span class="number">0</span>], x[<span class="number">0</span>], y[<span class="number">1</span>], x[<span class="number">1</span>], y[<span class="number">2</span>], x[<span class="number">2</span>]) ||</div><div class="line">			check2(y[<span class="number">0</span>], x[<span class="number">0</span>], y[<span class="number">2</span>], x[<span class="number">2</span>], y[<span class="number">1</span>], x[<span class="number">1</span>]) ||</div><div class="line">			check2(y[<span class="number">1</span>], x[<span class="number">1</span>], y[<span class="number">2</span>], x[<span class="number">2</span>], y[<span class="number">0</span>], x[<span class="number">0</span>])) &#123;</div><div class="line">			<span class="built_in">puts</span>(<span class="string">"2"</span><span class="number">2</span>);</div><div class="line">			<span class="keyword">continue</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">puts</span>(<span class="string">"3"</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="E-XOR-and-Favorite-Number"><a href="#E-XOR-and-Favorite-Number" class="headerlink" title="E. XOR and Favorite Number"></a>E. XOR and Favorite Number</h3><h4 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h4><p>给定长度为N的数列和M个询问，每次询问[L,R]区间内连续子串xor和为K的个数。</p>
<h4 id="分析-4"><a href="#分析-4" class="headerlink" title="分析"></a>分析</h4><p>离线处理。最优解的请参考<a href="http://blog.csdn.net/huzecong/article/details/8576908" target="_blank" rel="external">曼哈顿距离最小生成树与莫队算法</a>。我参考了一个时间复杂度近似但是<a href="http://blog.csdn.net/bossup/article/details/39236275" target="_blank" rel="external">编码复杂度较低的算法</a>。<br>看完上面两个之后，分析在已知(L,R)对应属性值的情况下如何从状态(L,R)转移到(L,R+1)，从而获得(L,R+1)对应属性值。增加的序列为[L,L+1…R+1], [L+1,L+2…R+1], [L+2,L+3…R+1]…[R,R+1], [R+1,R+1]，即求这些序列中xor值为K的个数，将这些序列同时xor[1,2,3…R+1]得到序列[1,2,3…L-1], [1,2,3…L]…[1,2,3…R], 可以看出这是序列的前缀xor，可以预处理并计数，转移的同时进行计数更新。(L,R)转移到(L,R-1), (L,R)转移到(L-1,R), (L, R)转移到(L+1,R)方法类似，不做过多陈述。注意边界处理和K=0时的特殊情况。</p>
<h4 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</div><div class="line"><span class="keyword">int</span> a[MAXN];</div><div class="line"><span class="keyword">int</span> N, M, K;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></div><div class="line">	<span class="keyword">int</span> l, r;</div><div class="line">	<span class="keyword">int</span> id;</div><div class="line">	<span class="keyword">int</span> block;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ans;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;other) <span class="keyword">const</span> &#123;</div><div class="line">		<span class="keyword">return</span> block != other.block? block &lt; other.block : r &lt; other.r;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">		id = i;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</div><div class="line">		block = (l - <span class="number">1</span>) / (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(<span class="number">1.0</span>*M);</div><div class="line">	&#125;</div><div class="line">&#125;q[MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> a.id &lt; b.id;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> le[MAXN], ri[MAXN];</div><div class="line"><span class="keyword">int</span> cnt[<span class="number">1</span> &lt;&lt; <span class="number">20</span>];</div><div class="line"><span class="keyword">bool</span> vis[<span class="number">1</span> &lt;&lt; <span class="number">20</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; K) &#123;</div><div class="line">		<span class="built_in">memset</span>(le, <span class="number">0</span>, <span class="keyword">sizeof</span>(le));</div><div class="line">		<span class="built_in">memset</span>(ri, <span class="number">0</span>, <span class="keyword">sizeof</span>(ri));</div><div class="line">		<span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</div><div class="line">		<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</div><div class="line">		<span class="built_in">memset</span>(q, <span class="number">0</span>, <span class="keyword">sizeof</span>(q));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; a[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</div><div class="line">			q[i].read(i);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) &#123;</div><div class="line">			le[i] = le[i - <span class="number">1</span>] ^ a[i];</div><div class="line">		&#125;</div><div class="line">		sort(q + <span class="number">1</span>, q + M + <span class="number">1</span>);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = q[<span class="number">1</span>].l - <span class="number">1</span>; i &lt;= q[<span class="number">1</span>].r; ++i) &#123;</div><div class="line">			cnt[le[i]]++;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (K == <span class="number">0</span>) &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; <span class="number">20</span>); ++i) &#123;</div><div class="line">				q[<span class="number">1</span>].ans += <span class="number">1l</span>l * cnt[i] * (cnt[i] - <span class="number">1</span>) / <span class="number">2</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; <span class="number">20</span>); ++i) &#123;</div><div class="line">				<span class="keyword">if</span> (!vis[i]) &#123;</div><div class="line">					q[<span class="number">1</span>].ans += <span class="number">1l</span>l * cnt[i] * cnt[i^K];</div><div class="line">					vis[i] = vis[i^K] = <span class="literal">true</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= M; ++i) &#123;</div><div class="line">			q[i].ans = q[i - <span class="number">1</span>].ans;</div><div class="line">			<span class="keyword">if</span> (q[i].r &gt; q[i - <span class="number">1</span>].r) &#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = q[i - <span class="number">1</span>].r + <span class="number">1</span>; j &lt;= q[i].r; ++j) &#123;</div><div class="line">					q[i].ans += cnt[le[j] ^ K];</div><div class="line">					cnt[le[j]]++;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (q[i].r &lt; q[i - <span class="number">1</span>].r) &#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = q[i - <span class="number">1</span>].r; j &gt; q[i].r; --j) &#123;</div><div class="line">					q[i].ans -= cnt[le[j] ^ K];</div><div class="line">					cnt[le[j]]--;</div><div class="line">					<span class="keyword">if</span> (K == <span class="number">0</span>) &#123;</div><div class="line">						q[i].ans++;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span> (q[i].l &gt; q[i - <span class="number">1</span>].l) &#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = q[i - <span class="number">1</span>].l - <span class="number">1</span>; j &lt;= q[i].l - <span class="number">2</span>; ++j) &#123;</div><div class="line">					q[i].ans -= cnt[le[j] ^ K];</div><div class="line">					cnt[le[j]]--;</div><div class="line">					<span class="keyword">if</span> (K == <span class="number">0</span>) &#123;</div><div class="line">						q[i].ans++;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (q[i].l &lt; q[i - <span class="number">1</span>].l)&#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = q[i - <span class="number">1</span>].l - <span class="number">2</span>; j &gt;= q[i].l - <span class="number">1</span>; --j) &#123;</div><div class="line">					q[i].ans += cnt[le[j] ^ K];</div><div class="line">					cnt[le[j]]++;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		sort(q + <span class="number">1</span>, q + M + <span class="number">1</span>, cmp);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= M; ++i) &#123;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; q[i].ans &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>感觉到自己的分析能力很弱，E题纸都画花了还调了半天才把答案凑出来。公式推导，等式转化的能力不强，边界处理又被绕晕了，做出来之后反过来想想并不难，但就是很难一步想到点子上，可能还是缺乏大量的练习吧。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/xuenene.jpg"
               alt="xuenene" />
          <p class="site-author-name" itemprop="name">xuenene</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xuenene</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
